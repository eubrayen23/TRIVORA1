<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Trivora ‚Ä¢ E-commerce</title>
  <meta name="description" content="Trivora ‚Äî E-commerce minimalista preto & branco. Telefones, eletr√¥nicos, moda masculina, moda feminina, beleza, servi√ßos e espa√ßo de marketing." />
  <style>
    /* =======================
       STYLES (completo)
       ======================= */
    :root{
      --bg:#fff; --fg:#0a0a0a; --muted:#6b6b6b; --soft:#f2f2f2; --accent:#000; --card:#ffffff;
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;height:100%}
    body{
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      color:var(--fg);
      background:var(--bg);
      line-height:1.6;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    .container{max-width:1200px;margin:0 auto;padding:0 20px}
    /* Header */
    .header{
      position:sticky;top:0;z-index:1000;background:#000;color:#fff;border-bottom:1px solid #111;
    }
    .header-wrap{display:flex;align-items:center;gap:16px;justify-content:space-between;padding:12px 0}
    .brand{font-weight:800;font-size:1.4rem;letter-spacing:.5px}
    .nav ul{display:flex;gap:12px;list-style:none;padding:0;margin:0;flex-wrap:wrap}
    .nav a{padding:8px 12px;border-radius:10px;transition:.2s}
    .nav a:hover,.nav a.active{background:rgba(255,255,255,.14)}
    /* Search */
    .search{display:flex;gap:0}
    .search input{padding:10px 12px;border:1px solid #222;background:#111;color:#fff;outline:none;border-right:0;border-radius:10px 0 0 10px;min-width:220px}
    .search button{border:1px solid #222;background:#1a1a1a;color:#fff;padding:10px 14px;border-radius:0 10px 10px 0;cursor:pointer}
    .search button:hover{background:#2a2a2a}
    /* minicart */
    .minicart{position:relative;display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px solid #222;border-radius:12px;background:#0f0f0f;color:#fff}
    .minicart .count{background:#fff;color:#000;border-radius:999px;padding:2px 8px;font-weight:700;font-size:.8rem}
    /* Banner/slider */
    .banner{margin:18px 0;border-radius:var(--radius);overflow:hidden;position:relative;background:#111;color:#fff}
    .slide{display:none;position:relative;min-height:320px}
    .slide.active{display:block}
    .slide .content{position:absolute;inset:0;display:grid;place-items:center;text-align:center;padding:24px}
    .slide h1{font-size:2rem;margin:0 0 8px 0}
    .slide p{color:#cfcfcf;margin:0 0 16px 0}
    .cta{display:inline-block;background:#fff;color:#000;padding:10px 16px;border-radius:10px;font-weight:700}
    .dots{position:absolute;left:50%;transform:translateX(-50%);bottom:14px;display:flex;gap:8px}
    .dot{width:10px;height:10px;border-radius:999px;background:#444;cursor:pointer}
    .dot.active{background:#fff}
    /* Layouts */
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px}
    .card{background:var(--card);border:1px solid #eee;border-radius:var(--radius);overflow:hidden;transition:.2s;display:flex;flex-direction:column}
    .card:hover{box-shadow:0 10px 40px rgba(0,0,0,.10);transform:translateY(-2px)}
    .card .thumb{height:180px;background:#f5f5f5;display:grid;place-items:center;overflow:hidden}
    .card h3{margin:12px 12px 0 12px;font-size:1rem}
    .card p.price{margin:6px 12px;color:#555;font-weight:700}
    .card .desc{margin:0 12px 12px 12px;color:#777;font-size:.9rem;flex:1}
    .card .meta{margin:0 12px 8px 12px;color:var(--muted);font-size:.85rem}
    .card button{margin:0 12px 12px 12px;padding:10px;border:0;border-radius:10px;background:#000;color:#fff;cursor:pointer}
    .card button:hover{filter:brightness(.9)}
    .kicker{display:flex;gap:18px;flex-wrap:wrap;margin:26px 0}
    .kicker .pill{padding:8px 12px;border:1px solid #ddd;border-radius:999px;background:#fff;cursor:pointer}
    .kicker .pill.active{background:#000;color:#fff;border-color:#000}
    /* Footer */
    .footer{margin-top:40px;background:#000;color:#fff;padding-top:20px}
    .footer .cols{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;padding:30px 0}
    .footer a{color:#fff;opacity:.9}
    .footer a:hover{opacity:1}
    .footer .bottom{border-top:1px solid #111;padding:14px 0;color:#bdbdbd;text-align:center}
    .badge{display:inline-block;border:1px solid #000;border-radius:8px;padding:6px 10px;font-weight:600}
    .sticky-checkout{position:fixed;right:16px;bottom:16px;z-index:1001;background:#fff;border:1px solid #ddd;border-radius:16px;padding:10px 14px;display:flex;align-items:center;gap:12px;box-shadow:0 12px 40px rgba(0,0,0,.14)}
    .sticky-checkout a{background:#000;color:#fff;padding:8px 12px;border-radius:10px}
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{border-bottom:1px solid #eee;padding:12px;text-align:left}
    .form{display:grid;gap:14px}
    .form .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .form input,.form select,.form textarea{padding:10px;border:1px solid #ddd;border-radius:10px;background:#fff}
    .form button{padding:12px;border:0;border-radius:10px;background:#000;color:#fff;cursor:pointer}
    .form button:hover{filter:brightness(.9)}
    .alert{padding:12px;border-radius:10px;background:#f6f6f6;border:1px solid #e6e6e6}
    .hidden{display:none}
    .section{padding:28px 0;border-bottom:1px solid #f0f0f0}
    .section h1{margin-top:0}
    @media (max-width:768px){.form .row{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <!-- HEADER -->
  <header class="header">
    <div class="container header-wrap">
      <a class="brand" href="#home" data-link>Trivora</a>
      <nav class="nav">
        <ul>
          <li><a href="#home" data-link class="nav-link">Home</a></li>
          <li><a href="#produtos" data-link class="nav-link">Produtos</a></li>
          <li><a href="#telefones" data-link class="nav-link">Telefones</a></li>
          <li><a href="#eletronicos" data-link class="nav-link">Eletr√¥nicos</a></li>
          <li><a href="#masculino" data-link class="nav-link">Masculino</a></li>
          <li><a href="#feminino" data-link class="nav-link">Feminino</a></li>
          <li><a href="#servicos" data-link class="nav-link">Servi√ßos</a></li>
          <li><a href="#marketing" data-link class="nav-link">Marketing</a></li>
          <li><a href="#conta" data-link class="nav-link">Minha Conta</a></li>
        </ul>
      </nav>
      <div style="display:flex;gap:12px;align-items:center">
        <form class="search" id="search-form" onsubmit="return false;">
          <input type="search" id="search-input" name="q" placeholder="Buscar..." aria-label="Buscar">
          <button id="search-btn">Buscar</button>
        </form>
        <div id="user-box"></div>
        <a class="minicart" href="#carrinho" data-link>üõí <span id="cart-count" class="count">0</span></a>
      </div>
    </div>
  </header>

  <!-- MAIN (one-page sections) -->
  <main class="container" id="main">
    <!-- HOME / BANNER -->
    <section id="home" class="section">
      <section class="banner" id="banner">
        <div class="slide active" data-slide="0">
          <div class="content">
            <div>
              <h1>Trivora ‚Äî Tecnologia, Moda e Servi√ßos</h1>
              <p>Produtos selecionados, experi√™ncia elegante e finaliza√ß√£o r√°pida.</p>
              <a class="cta" href="#produtos" data-link>Ver todos os produtos</a>
            </div>
          </div>
        </div>
        <div class="slide" data-slide="1">
          <div class="content">
            <div>
              <h1>Ofertas da Semana</h1>
              <p>Descontos em eletr√¥nicos e moda ‚Äî aproveite.</p>
              <a class="cta" href="#telefones" data-link>Conhecer</a>
            </div>
          </div>
        </div>
        <div class="slide" data-slide="2">
          <div class="content">
            <div>
              <h1>Espa√ßo de Marketing</h1>
              <p>Promova seu produto em destaque na Trivora.</p>
              <a class="cta" href="#marketing" data-link>Saiba mais</a>
            </div>
          </div>
        </div>
        <div class="dots" id="slider-dots"></div>
      </section>

      <div class="kicker">
        <a class="pill" href="#telefones" data-filter-anchor>Bolos</a>
        <a class="pill" href="#eletronicos" data-filter-anchor>Salgados</a>
        <a class="pill" href="#masculino" data-filter-anchor>Masculino</a>
        <a class="pill" href="#feminino" data-filter-anchor>Feminino</a>
        <a class="pill" href="#servicos" data-filter-anchor>Servi√ßos</a>
        <a class="pill" href="#marketing" data-filter-anchor>Marketing</a>
      </div>

      <div id="home-products" class="cards"></div>
    </section>

    <!-- ALL PRODUCTS (produtos) - searchable/filterable list -->
    <section id="produtos" class="section hidden">
      <h1>Todos os Produtos</h1>
      <div class="kicker" id="filters">
        <a class="pill active" data-filter="all">Todos</a>
        <a class="pill" data-filter="Telefones">Telefones</a>
        <a class="pill" data-filter="Eletronicos">Eletr√¥nicos</a>
        <a class="pill" data-filter="Masculino">Masculino</a>
        <a class="pill" data-filter="Feminino">Feminino</a>
        <a class="pill" data-filter="Beleza">Beleza</a>
        <a class="pill" data-filter="Servicos">Servi√ßos</a>
        <a class="pill" data-filter="Marketing">Marketing</a>
        <a class="pill" data-filter="ofertas">Ofertas</a>
      </div>
      <div id="products-grid" class="cards"></div>
    </section>

    <!-- CATEGORIES as sections (Telefones, Eletr√¥nicos, Masculino, Feminino, Servi√ßos, Marketing) -->
    <section id="telefones" class="section hidden">
      <h1>Telefones</h1>
      <div id="cat-telefones" class="cards"></div>
    </section>

    <section id="eletronicos" class="section hidden">
      <h1>Eletr√¥nicos</h1>
      <div id="cat-eletronicos" class="cards"></div>
    </section>

    <section id="masculino" class="section hidden">
      <h1>Universo Masculino</h1>
      <div id="cat-masculino" class="cards"></div>
    </section>

    <section id="feminino" class="section hidden">
      <h1>Universo Feminino & Beleza</h1>
      <div id="cat-feminino" class="cards"></div>
    </section>

    <section id="servicos" class="section hidden">
      <h1>Servi√ßos Online</h1>
      <div id="cat-servicos" class="cards"></div>
    </section>

    <section id="marketing" class="section hidden">
      <h1>Espa√ßo de Marketing</h1>
      <div id="cat-marketing" class="cards"></div>
    </section>

    <!-- CARRINHO -->
    <section id="carrinho" class="section hidden">
      <h1>Seu Carrinho</h1>
      <table class="table" id="cart-table">
        <thead><tr><th>Produto</th><th>Pre√ßo</th><th>Qtd</th><th>Subtotal</th><th></th></tr></thead>
        <tbody></tbody>
        <tfoot><tr><td colspan="3">Total</td><td id="cart-sum">Kz 0.00</td><td></td></tr></tfoot>
      </table>
      <div style="margin-top:18px">
        <a class="cta" href="#checkout" data-link>Ir para Checkout</a>
      </div>
    </section>

    <!-- CHECKOUT -->
    <section id="checkout" class="section hidden">
      <h1>Finalizar compra</h1>
      <div class="grid">
        <section style="grid-column:span 7">
          <form id="checkout-form" class="form">
            <div class="row">
              <input required name="name" placeholder="Nome completo"/>
              <input required name="email" type="email" placeholder="Email"/>
            </div>
            <input required name="address" placeholder="Endere√ßo completo"/>
            <div class="row">
              <input required name="phone" placeholder="Telefone"/>
              <select name="payment" required>
                <option value="">M√©todo de pagamento</option>
                <option>Multicaixa</option>
                <option>Unitel Money</option>
                <option>PayPal</option>
                <option>Stripe</option>
              </select>
            </div>
            <textarea name="notes" placeholder="Observa√ß√µes (opcional)"></textarea>
            <button type="submit">Confirmar Pedido</button>
          </form>
          <p class="alert">Pagamento simulado: ao confirmar, o pedido ser√° salvo e ficar√° dispon√≠vel em "Minha Conta".</p>
        </section>

        <aside style="grid-column:span 5">
          <h3>Resumo</h3>
          <table class="table" id="summary">
            <thead><tr><th>Produto</th><th>Qtd</th><th>Total</th></tr></thead>
            <tbody></tbody>
            <tfoot><tr><td colspan="2">Total</td><td id="sum-total">Kz 0.00</td></tr></tfoot>
          </table>
        </aside>
      </div>
    </section>

    <!-- LOGIN / REGISTRO / CONTA -->
    <section id="login" class="section hidden">
      <h1>Entrar</h1>
      <form id="login-form" class="form" style="max-width:480px">
        <input name="email" type="email" placeholder="Email" required/>
        <input name="password" type="password" placeholder="Senha" required/>
        <button>Entrar</button>
      </form>
      <p>N√£o tem conta? <a href="#registro" data-link>Registre-se</a></p>
    </section>

    <section id="registro" class="section hidden">
      <h1>Criar conta</h1>
      <form id="reg-form" class="form" style="max-width:480px">
        <input name="name" placeholder="Nome" required/>
        <input name="email" type="email" placeholder="Email" required/>
        <input name="phone" placeholder="Telefone" required/>
        <input name="password" type="password" placeholder="Senha" required/>
        <button>Criar minha conta</button>
      </form>
    </section>

    <section id="conta" class="section hidden">
      <h1>Minha Conta</h1>
      <div style="display:flex;gap:12px;align-items:center;margin-bottom:12px">
        <div id="user-data" class="alert"></div>
        <button id="logout-btn" class="badge" style="background:#fff;padding:6px 12px;border:1px solid #ddd">Sair</button>
      </div>
      <div class="kicker" style="margin-bottom:18px">
        <a class="pill active" href="#dados" data-tab>Meus dados</a>
        <a class="pill" href="#pedidos" data-tab>Pedidos</a>
      </div>

      <section id="dados">
        <h3>Dados b√°sicos</h3>
        <div id="user-basic" class="alert"></div>
      </section>

      <section id="pedidos" style="margin-top:20px">
        <h3>Meus pedidos</h3>
        <table class="table" id="orders-table">
          <thead><tr><th>Pedido</th><th>Data</th><th>Itens</th><th>Total</th><th>Status</th></tr></thead>
          <tbody></tbody>
        </table>
      </section>
    </section>

    <!-- CONTATO -->
    <section id="contato" class="section hidden">
      <h1>Contato</h1>
      <form id="contact-form" class="form" style="max-width:520px">
        <input name="name" placeholder="Seu nome" required/>
        <input name="email" type="email" placeholder="Seu email" required/>
        <textarea name="message" placeholder="Mensagem" rows="5" required></textarea>
        <button>Enviar</button>
      </form>
    </section>
  </main>

  <!-- FOOTER + STICKY -->
  <footer class="footer">
    <div class="container cols" style="padding:18px 20px;">
      <div>
        <strong>Trivora</strong>
        <p>E-commerce elegante, simples e r√°pido.</p>
      </div>
      <div>
        <strong>Categorias</strong>
        <ul style="list-style:none;padding:0;margin:0">
          <li><a href="#telefones" data-link>Telefones</a></li>
          <li><a href="#eletronicos" data-link>Eletr√¥nicos</a></li>
          <li><a href="#masculino" data-link>Masculino</a></li>
          <li><a href="#feminino" data-link>Feminino</a></li>
          <li><a href="#servicos" data-link>Servi√ßos</a></li>
          <li><a href="#marketing" data-link>Marketing</a></li>
        </ul>
      </div>
      <div>
        <strong>Ajuda</strong>
        <ul style="list-style:none;padding:0;margin:0">
          <li><a href="#login" data-link>Login</a> / <a href="#registro" data-link>Registro</a></li>
          <li><a href="#checkout" data-link>Checkout</a></li>
          <li><a href="#contato" data-link>Contato</a></li>
        </ul>
      </div>
    </div>
    <div class="bottom" style="padding:12px 0;text-align:center;color:#bdbdbd">&copy; 2025 Trivora. Todos os direitos reservados.</div>
  </footer>

  <div class="sticky-checkout">
    <span>Total: <strong>Kz <span id="cart-total">0.00</span></strong></span>
    <a href="#checkout" data-link>Finalizar</a>
  </div>

  <!-- =======================
       SCRIPTS EMBUTIDOS (produtos + app)
       ======================= -->
  <script>
    /* ===== produtos (com at√© 5 produtos por categoria) =====
       Imagens via Unsplash (aleat√≥rias por keyword) para encaixar automaticamente.
    */
    const U = (q) => `https://source.unsplash.com/600x600/?${encodeURIComponent(q)}`;
    window.TRIVORA_PRODUCTS = [
      // Telefones (5)
      {id:'tel1', category:'Telefones', name:'iPhone 15 Pro', price:850000, img: U('iphone,phone,apple'), desc:'Desempenho Pro, c√¢mera avan√ßada e design premium.'},
      {id:'tel2', category:'Telefones', name:'Samsung Galaxy S24', price:620000, img: U('samsung,phone,android'), desc:'Tela AMOLED, bateria duradoura e c√¢mera vers√°til.'},
      {id:'tel3', category:'Telefones', name:'Xiaomi 14', price:340000, img: U('xiaomi,phone,smartphone'), desc:'√ìtimo custo-benef√≠cio e performance.'},
      {id:'tel4', category:'Telefones', name:'Google Pixel 8', price:410000, img: U('google pixel,phone,camera'), desc:'C√¢mera topo de linha com software inteligente.'},
      {id:'tel5', category:'Telefones', name:'OnePlus 12', price:380000, img: U('oneplus,phone,technology'), desc:'Velocidade e carregamento ultra r√°pido.'},

      // Eletr√¥nicos (5)
      {id:'ele1', category:'Eletronicos', name:'Smart TV 55" 4K', price:300000, img: U('smart tv,television,4k'), desc:'4K UHD, HDR e smart apps integrados.'},
      {id:'ele2', category:'Eletronicos', name:'Laptop Ultrabook 14"', price:540000, img: U('laptop,notebook,ultrabook'), desc:'Leve, potente e bateria para o dia todo.'},
      {id:'ele3', category:'Eletronicos', name:'Headset Wireless', price:42000, img: U('headphones,wireless,audio'), desc:'Cancelamento de ru√≠do e som premium.'},
      {id:'ele4', category:'Eletronicos', name:'Smartwatch', price:85000, img: U('smartwatch,wearable,tech'), desc:'Monitor de sa√∫de e notifica√ß√µes inteligentes.'},
      {id:'ele5', category:'Eletronicos', name:'C√¢mera Mirrorless', price:280000, img: U('camera,mirrorless,photography'), desc:'Qualidade profissional em corpo compacto.'},

      // Masculino (5) - tenis e roupa inclu√≠dos
      {id:'mas1', category:'Masculino', name:'T√™nis Running Pro', price:45000, img: U('mens shoes,running,sneakers'), desc:'Amortecimento avan√ßado para treinos.'},
      {id:'mas2', category:'Masculino', name:'Camiseta Premium', price:8000, img: U('mens t-shirt,fashion'), desc:'Corte moderno e tecido respir√°vel.'},
      {id:'mas3', category:'Masculino', name:'Rel√≥gio Cl√°ssico', price:90000, img: U('mens watch,classic'), desc:'Design sofisticado para o dia a dia.'},
      {id:'mas4', category:'Masculino', name:'Jaqueta Bomber', price:46000, img: U('mens jacket,bomber'), desc:'Estilo urbano e isolamento leve.'},
      {id:'mas5', category:'Masculino', name:'Cal√ßa Chino', price:22000, img: U('mens pants,chino'), desc:'Vers√°til: do trabalho ao fim de semana.'},

      // Feminino (5) - moda + beleza categoria 'Beleza' internal as separate category too
      {id:'fem1', category:'Feminino', name:'Vestido Floral', price:25000, img: U('womens dress,floral,fashion'), desc:'Leve, moderno e perfeito para eventos.'},
      {id:'fem2', category:'Feminino', name:'Sand√°lia Salto', price:42000, img: U('womens heels,sandals'), desc:'Eleg√¢ncia com conforto para a noite.'},
      {id:'fem3', category:'Feminino', name:'Bolsa Tiracolo', price:52000, img: U('womens bag,handbag'), desc:'Acabamento premium e espa√ßo interno.'},
      {id:'fem4', category:'Feminino', name:'Blusa Cropped', price:12000, img: U('womens blouse,cropped,fashion'), desc:'Vers√°til e estilosa.'},
      {id:'fem5', category:'Feminino', name:'Conjunto Casual', price:32000, img: U('womens outfit,casual'), desc:'Conforto e personalidade.'},

      // Beleza (5) - subcategoria
      {id:'bez1', category:'Beleza', name:'Kit Maquiagem', price:15000, img: U('makeup,beauty,cosmetics'), desc:'Completo para o dia a dia e eventos.'},
      {id:'bez2', category:'Beleza', name:'Perfume Signature', price:28000, img: U('perfume,bottle,fragrance'), desc:'Notas marcantes e duradouras.'},
      {id:'bez3', category:'Beleza', name:'Skincare Set', price:22000, img: U('skincare,beauty,cosmetics'), desc:'Rotina completa para hidrata√ß√£o.'},
      {id:'bez4', category:'Beleza', name:'M√°scara Facial', price:5000, img: U('face mask,beauty'), desc:'Tratamento r√°pido e refrescante.'},
      {id:'bez5', category:'Beleza', name:'Pinc√©is Profissionais', price:7500, img: U('makeup brushes,cosmetics'), desc:'Precis√£o e acabamento perfeito.'},

      // Servi√ßos (5)
      {id:'srv1', category:'Servicos', name:'Design de Logo', price:20000, img: U('logo design,branding,graphic'), desc:'Identidade visual profissional para sua marca.'},
      {id:'srv2', category:'Servicos', name:'Landing Page', price:18000, img: U('website design,webpage'), desc:'P√°gina de vendas otimizada para convers√£o.'},
      {id:'srv3', category:'Servicos', name:'Gest√£o de Redes Sociais', price:25000, img: U('social media,marketing'), desc:'Conte√∫do, calend√°rio e an√∫ncios.'},
      {id:'srv4', category:'Servicos', name:'Fotografia de Produto', price:12000, img: U('product photography,studio'), desc:'Imagens profissionais para loja e an√∫ncios.'},
      {id:'srv5', category:'Servicos', name:'Consultoria SEO', price:16000, img: U('seo,analytics,marketing'), desc:'Melhore seu posicionamento e tr√°fego org√¢nico.'},

      // Marketing (5)
      {id:'mkt1', category:'Marketing', name:'An√∫ncio em Destaque', price:10000, img: U('advertising,marketing,ad'), desc:'Coloque seu produto em destaque no topo da p√°gina.'},
      {id:'mkt2', category:'Marketing', name:'Banner Rotativo', price:7000, img: U('banner,ad,marketing'), desc:'Banner inserido em posi√ß√µes estrat√©gicas.'},
      {id:'mkt3', category:'Marketing', name:'Campanha Promocional', price:30000, img: U('campaign,marketing,promo'), desc:'Cria√ß√£o e gest√£o completa da campanha.'},
      {id:'mkt4', category:'Marketing', name:'Vitrine Premium', price:15000, img: U('storefront,display,marketing'), desc:'Espa√ßo destacado para seus produtos.'},
      {id:'mkt5', category:'Marketing', name:'Newsletter Patrocinada', price:9000, img: U('newsletter,email marketing'), desc:'Envio de campanha para nossa base qualificada.'}
    ];
  </script>

  <script>
    /* ===== app.js (adaptado para single-page) ===== */
    const $ = (sel,ctx=document)=>ctx.querySelector(sel);
    const $$ = (sel,ctx=document)=>Array.from((ctx||document).querySelectorAll(sel));

    // STORAGE helpers
    const store = {
      get(key, fallback=null){
        try{ const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; } catch(e){ return fallback; }
      },
      set(key, val){ localStorage.setItem(key, JSON.stringify(val)) },
      remove(key){ localStorage.removeItem(key) }
    };

    // AUTH (local)
    const auth = {
      user(){ return store.get('trivora:user', null) },
      login(email, password){
        const users = store.get('trivora:users', []);
        const u = users.find(x=>x.email===email && x.password===password);
        if(!u) return {ok:false, msg:'Credenciais inv√°lidas'};
        store.set('trivora:user', {email:u.email, name:u.name, phone:u.phone});
        return {ok:true}
      },
      register({name,email,password,phone}){
        const users = store.get('trivora:users', []);
        if(users.some(u=>u.email===email)) return {ok:false, msg:'Email j√° registrado'};
        users.push({name,email,password,phone});
        store.set('trivora:users', users);
        store.set('trivora:user', {email,name,phone});
        return {ok:true}
      },
      logout(){ store.remove('trivora:user') }
    };

    // CART
    const cart = {
      key:'trivora:cart',
      all(){ return store.get(this.key, []) },
      save(items){ store.set(this.key, items); ui.updateCartCount() },
      add(productId, qty=1){
        const items = this.all();
        const item = items.find(i=>i.id===productId);
        if(item) item.qty += qty; else items.push({id:productId, qty});
        this.save(items);
        ui.flash('Produto adicionado ao carrinho.');
      },
      remove(productId){
        const items = this.all().filter(i=>i.id!==productId);
        this.save(items);
      },
      setQty(productId, qty){
        const items = this.all();
        const item = items.find(i=>i.id===productId);
        if(item){ item.qty = Math.max(1, qty); this.save(items) }
      },
      clear(){ this.save([]) },
      total(){
        return this.all().reduce((sum,i)=>{
          const p = products.get(i.id); return sum + (p?.price || 0) * i.qty
        },0)
      },
      count(){ return this.all().reduce((n,i)=>n+i.qty,0) }
    };

    // PRODUCTS helper
    const products = (function(){
      const list = window.TRIVORA_PRODUCTS || [];
      const map = new Map(list.map(p=>[p.id,p]));
      const byCategory = (cat)=>list.filter(p=>p.category===cat);
      const get = (id)=>map.get(id);
      return {list, byCategory, get};
    })();

    // ORDERS
    const orders = {
      key:'trivora:orders',
      all(){ return store.get(this.key, []) },
      add(order){ const list=this.all(); list.push(order); store.set(this.key,list) }
    };

    // UI helpers
    const ui = {
      updateCartCount(){
        const el = $('#cart-count'); if(el) el.textContent = cart.count();
        const el2 = $('#cart-total'); if(el2) el2.textContent = cart.total().toFixed(2);
        const el3 = $('#cart-sum'); if(el3) el3.textContent = 'Kz ' + cart.total().toFixed(2);
      },
      flash(msg){
        const a = document.createElement('div');
        a.className = 'alert center';
        a.textContent = msg;
        a.style.position='fixed'; a.style.left='50%'; a.style.top='12px'; a.style.transform='translateX(-50%)';
        a.style.zIndex='2000'; a.style.background='#fff'; a.style.border='1px solid #ddd';
        document.body.appendChild(a);
        setTimeout(()=>a.remove(),1800);
      },
      formatMoney(v){ return 'Kz ' + v.toFixed(2) }
    };

    // Slider
    function initSlider(){
      const slides = $$('.slide'); const dotsContainer = $('#slider-dots');
      if(!slides.length) return;
      dotsContainer.innerHTML = slides.map((s,i)=>`<span class="dot ${i===0?'active':''}" data-i="${i}"></span>`).join('');
      const dots = $$('.dot', dotsContainer);
      let idx = 0;
      const show = i => {
        slides.forEach((s,k)=>s.classList.toggle('active',k===i));
        dots.forEach((d,k)=>d.classList.toggle('active',k===i));
        idx = i;
      };
      dots.forEach(d=>d.addEventListener('click', ()=> show(parseInt(d.dataset.i))));
      setInterval(()=>show((idx+1)%slides.length), 5000);
    }

    // product card
    function productCardHTML(p){
      return `<div class="card" data-id="${p.id}">
        <div class="thumb"><img src="${p.img}" alt="${p.name}" onerror="this.style.opacity=.06;this.style.filter='grayscale(1)';"></div>
        <h3>${p.name}</h3>
        <p class="price">Kz ${p.price.toFixed(2)}</p>
        <p class="desc">${p.desc}</p>
        <p class="meta">Categoria: ${p.category}</p>
        <button class="add-cart" data-id="${p.id}">Adicionar ao carrinho</button>
      </div>`;
    }

    // Renderers
    function renderHomePicks(){
      const root = $('#home-products');
      const picks = products.list.slice(0,8);
      root.innerHTML = picks.map(p=>productCardHTML(p)).join('');
      bindAddCartButtons(root);
    }
    function renderAllProducts(list=products.list){
      const root = $('#products-grid');
      root.innerHTML = list.map(p=>productCardHTML(p)).join('');
      bindAddCartButtons(root);
    }
    function renderCategory(cat, selector){
      const root = $(selector);
      const list = products.byCategory(cat);
      root.innerHTML = list.map(p=>productCardHTML(p)).join('');
      bindAddCartButtons(root);
    }

    // Bind add to cart buttons within a container
    function bindAddCartButtons(root=document){
      $$('.add-cart', root).forEach(btn=>{
        btn.removeEventListener('click', addCartHandler);
        btn.addEventListener('click', addCartHandler);
      });
    }
    function addCartHandler(e){
      const id = e.currentTarget.dataset.id;
      cart.add(id,1);
      updateCartDisplays();
      renderCartTable();
    }

    // Cart render
    function renderCartTable(){
      const tbody = document.querySelector('#cart-table tbody');
      const items = cart.all();
      if(items.length===0){
        tbody.innerHTML = '<tr><td colspan="5" class="center">Seu carrinho est√° vazio.</td></tr>';
        ui.updateCartCount();
        $('#cart-sum').textContent = 'Kz 0.00';
        return;
      }
      tbody.innerHTML = items.map(i=> {
        const p = products.get(i.id);
        const sub = (p.price * i.qty);
        return `<tr>
          <td style="display:flex;align-items:center;gap:10px"><img src="${p.img}" alt="${p.name}" style="width:60px;height:60px;object-fit:cover;border-radius:8px" onerror="this.style.opacity=.06;"> ${p.name}</td>
          <td>Kz ${p.price.toFixed(2)}</td>
          <td><input type="number" min="1" value="${i.qty}" style="width:70px" data-id="${i.id}" class="qty"/></td>
          <td>Kz ${sub.toFixed(2)}</td>
          <td><button data-id="${i.id}" class="rm">Remover</button></td>
        </tr>`;
      }).join('');
      $('#cart-sum').textContent = 'Kz ' + cart.total().toFixed(2);
      ui.updateCartCount();
      $$('.qty').forEach(inp=>{
        inp.addEventListener('input', ()=>{
          cart.setQty(inp.dataset.id, parseInt(inp.value||'1'));
          renderCartTable();
        });
      });
      $$('.rm').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          cart.remove(btn.dataset.id);
          renderCartTable();
        });
      });
    }

    // Checkout summary
    function renderCheckoutSummary(){
      const tb = $('#summary tbody');
      const items = cart.all();
      if(items.length===0){
        tb.innerHTML = '<tr><td colspan="3">Nenhum item no carrinho.</td></tr>';
      } else {
        tb.innerHTML = items.map(i=>{
          const p = products.get(i.id);
          return `<tr><td>${p.name}</td><td>${i.qty}</td><td>Kz ${(p.price * i.qty).toFixed(2)}</td></tr>`;
        }).join('');
      }
      $('#sum-total').textContent = 'Kz ' + cart.total().toFixed(2);
      ui.updateCartCount();
    }

    // Account render
    function renderAccount(){
      const u = auth.user();
      if(!u) return;
      $('#user-basic').textContent = `${u.name || ''} ‚Ä¢ ${u.email} ‚Ä¢ ${u.phone || ''}`;
      $('#user-data').textContent = `${u.name || ''} ‚Ä¢ ${u.email} ‚Ä¢ ${u.phone || ''}`;
      const tb = $('#orders-table tbody');
      const list = orders.all().filter(o=>o.customer.email===u.email);
      tb.innerHTML = list.length ? list.map(o=>`<tr>
        <td>${o.id}</td>
        <td>${new Date(o.createdAt).toLocaleString()}</td>
        <td>${o.items.reduce((n,i)=>n+i.qty,0)}</td>
        <td>Kz ${o.total.toFixed(2)}</td>
        <td>${o.status}</td>
      </tr>`).join('') : '<tr><td colspan="5">Sem pedidos ainda.</td></tr>';
    }

    // Update displays
    function updateCartDisplays(){
      ui.updateCartCount();
      renderStickyTotal();
    }
    function renderStickyTotal(){ $('#cart-total').textContent = cart.total().toFixed(2); }

    // Hash routing
    function showSectionByHash(){
      const hash = location.hash.replace('#','') || 'home';
      // hide all sections
      $$('.section').forEach(s=>s.classList.add('hidden'));
      const target = document.getElementById(hash);
      if(target){
        target.classList.remove('hidden');
        setTimeout(()=>{ target.scrollIntoView({behavior:'smooth', block:'start'}); }, 80);
      } else {
        $('#home').classList.remove('hidden');
      }
      // update nav active
      $$('.nav-link').forEach(a=>{
        const href = (a.getAttribute('href')||'').replace('#','') || 'home';
        a.classList.toggle('active', href === hash);
      });
      // Render context
      if(hash === 'home'){ renderHomePicks(); initSlider(); }
      if(hash === 'produtos'){ renderAllProducts(); }
      if(hash === 'telefones'){ renderCategory('Telefones','#cat-telefones'); }
      if(hash === 'eletronicos'){ renderCategory('Eletronicos','#cat-eletronicos'); }
      if(hash === 'masculino'){ renderCategory('Masculino','#cat-masculino'); }
      if(hash === 'feminino'){ renderCategory('Feminino','#cat-feminino'); renderCategory('Beleza','#cat-feminino'); }
      if(hash === 'servicos'){ renderCategory('Servicos','#cat-servicos'); }
      if(hash === 'marketing'){ renderCategory('Marketing','#cat-marketing'); }
      if(hash === 'carrinho'){ renderCartTable(); }
      if(hash === 'checkout'){ renderCheckoutSummary(); }
      if(hash === 'conta'){ const u = auth.user(); if(!u){ location.hash = 'login'; } else { renderAccount(); } }
    }

    // Search
    function doSearch(q){
      q = (q||'').trim().toLowerCase();
      let list = products.list;
      if(q) list = list.filter(p=> p.name.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
      location.hash = 'produtos';
      setTimeout(()=>{ renderAllProducts(list); }, 50);
    }

    // Filters binding
    function bindFilters(){
      $('#filters').addEventListener('click', (e)=>{
        if(!e.target.matches('.pill')) return;
        $$('.pill','#filters').forEach(p=>p.classList.remove('active'));
        e.target.classList.add('active');
        const f = e.target.dataset.filter;
        if(f === 'all') renderAllProducts();
        else if(f === 'ofertas') renderAllProducts(products.list.filter(p=>p.price < 30000)); // example ofertas
        else renderAllProducts(products.list.filter(p=>p.category === f));
      });
      // kicker pills
      $$('.kicker .pill').forEach(p=>{
        p.addEventListener('click', (ev)=>{
          const txt = p.textContent.trim();
          const map = {'Bolos':'telefones','Salgados':'eletronicos'}; // legacy names, but user likes layout - keep mapping simple
          if(['Telefones','Eletr√¥nicos','Masculino','Feminino','Servi√ßos','Marketing'].includes(txt)){
            location.hash = txt.toLowerCase();
          } else if (txt === 'Bolos'){ location.hash = 'telefones'; }
          else if (txt === 'Salgados'){ location.hash = 'eletronicos'; }
          else location.hash = 'produtos';
        });
      });
    }

    // Bind search form
    document.getElementById('search-form').addEventListener('submit', (e)=>{ e.preventDefault(); doSearch($('#search-input').value); });
    $('#search-btn').addEventListener('click', ()=> doSearch($('#search-input').value));

    // Register & login
    document.getElementById('reg-form').addEventListener('submit', (e)=>{
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target).entries());
      const res = auth.register(data);
      if(!res.ok) return ui.flash(res.msg);
      ui.flash('Conta criada!');
      updateHeaderUser();
      location.hash = 'conta';
    });

    document.getElementById('login-form').addEventListener('submit', (e)=>{
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target).entries());
      const res = auth.login(data.email, data.password);
      if(!res.ok) return ui.flash(res.msg);
      ui.flash('Entrou com sucesso!');
      updateHeaderUser();
      location.hash = 'conta';
    });

    // Logout
    $('#logout-btn').addEventListener('click', ()=>{
      auth.logout();
      ui.flash('Sess√£o encerrada.');
      updateHeaderUser();
      location.hash = 'home';
    });

    // Checkout submit
    $('#checkout-form').addEventListener('submit', (e)=>{
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target).entries());
      if(cart.count() === 0) return ui.flash('Adicione itens ao carrinho.');
      const order = {
        id: 'ORD-' + Date.now(),
        items: cart.all(),
        total: cart.total(),
        customer: data,
        status: 'Pago (Simulado via ' + data.payment + ')',
        createdAt: new Date().toISOString()
      };
      alert('Simula√ß√£o de pagamento: redirecionando para ' + data.payment + '...');
      orders.add(order);
      cart.clear();
      updateCartDisplays();
      ui.flash('Pedido confirmado!');
      const u = auth.user();
      if(u && u.email === data.email){
        location.hash = 'conta';
        setTimeout(()=>renderAccount(), 300);
      } else {
        // still go to account (guest) so user sees confirmation
        location.hash = 'conta';
        setTimeout(()=>renderAccount(), 300);
      }
    });

    // Contact form
    $('#contact-form').addEventListener('submit', (e)=>{
      e.preventDefault();
      ui.flash('Mensagem enviada ‚Äî responderemos em breve.');
      e.target.reset();
    });

    // Delegated anchors & filter anchors
    document.addEventListener('click', (e)=>{
      if(e.target.matches('[data-link]')){
        const href = e.target.getAttribute('href') || '';
        if(href.startsWith('#')){
          const h = href.replace('#','');
          location.hash = h;
          e.preventDefault();
        }
      }
      if(e.target.matches('[data-filter-anchor]')){
        const txt = e.target.textContent.trim();
        const map = {'Bolos':'telefones','Salgados':'eletronicos'};
        if(map[txt]) location.hash = map[txt];
        else location.hash = txt.toLowerCase();
      }
    });

    // Header user box
    function updateHeaderUser(){
      const user = auth.user();
      const userBox = $('#user-box');
      if(user){
        userBox.innerHTML = `<span class="badge">Ol√°, ${user.name || user.email}</span>`;
      } else {
        userBox.innerHTML = `<a href="#login" data-link class="badge">Entrar</a>`;
      }
      ui.updateCartCount();
    }

    // Init app
    function initApp(){
      updateHeaderUser();
      initSlider();
      renderHomePicks();
      renderAllProducts();
      renderCategory('Telefones','#cat-telefones');
      renderCategory('Eletronicos','#cat-eletronicos');
      renderCategory('Masculino','#cat-masculino');
      renderCategory('Feminino','#cat-feminino'); // Feminino will also show Beleza where applicable
      renderCategory('Beleza','#cat-feminino');
      renderCategory('Servicos','#cat-servicos');
      renderCategory('Marketing','#cat-marketing');
      bindFilters();
      renderCartTable();
      renderStickyTotal();
      window.addEventListener('hashchange', showSectionByHash);
      showSectionByHash();
      $$('.nav-link').forEach(a=>a.addEventListener('click', ()=> setTimeout(()=> showSectionByHash(), 50)));
    }

    // Expose for manual actions (debug)
    window.cart = cart; window.products = products; window.auth = auth; window.orders = orders; window.ui = ui;

    // Start
    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>


